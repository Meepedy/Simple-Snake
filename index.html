<!DOCTYPE HTML>
<html>
    <head>
      <title>Snake Game</title>
    </head>
    <body onload="load()">
        <h2><span id="score">Score: 0</span></h2>
        <canvas id="gameCanvas" width="400" height="400"></canvas>
    </body>
</html>

<script>
window.onload = function () {
    canv = document.getElementById("gameCanvas");
    context = canv.getContext("2d");
    document.addEventListener("keydown", keyPush);
    setInterval(game, 1000 / 15);
}

playerX = 10;
playerY = 10;
gridSize = 20;
tileCount = 20;
appleX = 15;
appleY = 15;
xVelocity = 0;
yVelocity = 0;
trail = [];
tail = 5;
score = 0;

function game() {
    playerX += xVelocity;
    playerY += yVelocity;
    if (playerX < 0) {
        playerX = tileCount - 1;
    }
    if (playerX > tileCount - 1) {
        playerX = 0;
    }
    if (playerY < 0) {
        playerY = tileCount - 1;
    }
    if (playerY > tileCount - 1) {
        playerY = 0;
    }

    context.fillStyle = "#71C5CF";
    context.fillRect(0, 0, canv.width, canv.height);

    context.fillStyle = "#74BF2E";
    for (var i = 0; i < trail.length; i++) {
        context.fillRect(trail[i].x * gridSize, trail[i].y * gridSize, gridSize - 2, gridSize - 2);
        if (trail[i].x == playerX && trail[i].y == playerY) {
            tail = 5;
            score = 0;
        }
    }
    trail.push({
        x: playerX,
        y: playerY
    });
    while (trail.length > tail) {
        trail.shift();
    }

    if (appleX == playerX && appleY == playerY) {
        tail++;
        score++;
        document.getElementById("score").innerText = "Score: " + score;

        appleX = Math.floor(Math.random() * tileCount);
        appleY = Math.floor(Math.random() * tileCount);
    }
    context.fillStyle = "#FF6A00";
    context.fillRect(appleX * gridSize, appleY * gridSize, gridSize - 2, gridSize - 2);
}

function keyPush(evt) {
    switch (evt.keyCode) {
        //WASD key movements
    case 65:
        xVelocity = -1;
        yVelocity = 0;
        break;
    case 87:
        xVelocity = 0;
        yVelocity = -1;
        break;
    case 68:
        xVelocity = 1;
        yVelocity = 0;
        break;
    case 83:
        xVelocity = 0;
        yVelocity = 1;
        break;
    }
}
</script>
